<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ğŸ”¥ ì‚°ë¶ˆ ì˜ˆì¸¡ ë¹„êµ ëŒ€ì‹œë³´ë“œ</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <style>
        #map { height: 100vh; }
    </style>
</head>
<body>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

    <script>
        const map = L.map('map').setView([37.5, 128.2], 7);

        const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{x}.png', { attribution: 'OpenStreetMap' }).addTo(map);
        const satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { attribution: 'Esri' });

        const trueFires = L.layerGroup().addTo(map);
        const predWeather = L.layerGroup().addTo(map);
        const predBaseline = L.layerGroup().addTo(map);

        L.control.layers(
            { "ì§€ë„": osm, "ìœ„ì„±": satellite },
            {
                "ì‹¤ì œ ì‚°ë¶ˆ": trueFires,
                "ë‚ ì”¨ ê³ ë ¤ ì˜ˆì¸¡": predWeather,
                "ë‚ ì”¨ ë¯¸ê³ ë ¤ ì˜ˆì¸¡": predBaseline
            }
        ).addTo(map);

        // ğŸ”¥ GeoJSON ë¡œë“œ
        function loadGeoJson(url, layerGroup, iconColor) {
            fetch(url)
                .then(res => res.json())
                .then(data => {
                    L.geoJSON(data, {
                        pointToLayer: (feature, latlng) => L.marker(latlng, {
                            icon: L.icon({
                                iconUrl: 'https://cdn-icons-png.flaticon.com/512/482/482464.png',
                                iconSize: [20, 20],
                                iconAnchor: [10, 10]
                            })
                        }),
                        onEachFeature: (feature, layer) => {
                            if (feature.properties && feature.properties.popup) {
                                layer.bindPopup(feature.properties.popup);
                            }
                        }
                    }).addTo(layerGroup);
                });
        }

        loadGeoJson('data/true_fires.geojson', trueFires, 'red');
        loadGeoJson('data/predicted_weather.geojson', predWeather, 'blue');
        loadGeoJson('data/predicted_baseline.geojson', predBaseline, 'orange');

        // ğŸ” ê²€ìƒ‰ ê¸°ëŠ¥ (ì£¼ì†Œ/ì§€ì—­ëª… ê¸°ë°˜ ì‹œì  ì´ë™)
        const geocoder = L.Control.geocoder({
            defaultMarkGeocode: false
        })
        .on('markgeocode', function(e) {
            const center = e.geocode.center;
            map.flyTo(center, 12);
        })
        .addTo(map);
    </script>
</body>
</html>
