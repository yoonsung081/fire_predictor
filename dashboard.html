<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ğŸ”¥ ì„±ëŠ¥ ë¹„êµ ëŒ€ì‹œë³´ë“œ</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
    canvas { max-width: 500px; margin: 30px auto; }
    a { display: inline-block; margin-top: 30px; text-decoration: none; padding: 8px 16px; border: 1px solid #ccc; border-radius: 4px; background: #fff; }
  </style>
</head>
<body>
  <h1>ğŸ”¥ ì„±ëŠ¥ ì§€í‘œ ë¹„êµ</h1>
  <canvas id="metricsChart"></canvas>

  <a href="index.html">â† ì§€ë„ ë³´ê¸°ë¡œ ëŒì•„ê°€ê¸°</a>

  <script>
    fetch('static/metrics.json')
      .then(response => {
        if (!response.ok) {
          throw new Error("metrics.json íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        }
        return response.json();
      })
      .then(data => {
        const labels = ['ì •í™•ë„ (Accuracy)', 'ì •ë°€ë„ (Precision)', 'ì¬í˜„ìœ¨ (Recall)', 'F1-Score'];
        const chartDatasets = [];

        // LightGBM (Baseline) ë°ì´í„° ì²˜ë¦¬
        if (data.baseline) {
          chartDatasets.push({
            label: 'LightGBM (Baseline)',
            data: [
              data.baseline.accuracy * 100,
              data.baseline.precision * 100,
              data.baseline.recall * 100,
              data.baseline.f1 * 100
            ],
            backgroundColor: 'rgba(153, 102, 255, 0.7)' // Purple
          });
        }

        // Transformer ë°ì´í„° ì²˜ë¦¬
        if (data.transformer) {
          chartDatasets.push({
            label: 'Transformer',
            data: [
              data.transformer.accuracy * 100,
              data.transformer.precision * 100,
              data.transformer.recall * 100,
              data.transformer.f1 * 100
            ],
            backgroundColor: 'rgba(75, 192, 192, 0.7)' // Teal
          });
        }
        
        if (chartDatasets.length === 0) {
            document.body.innerHTML += '<p>í‘œì‹œí•  ì„±ëŠ¥ ì§€í‘œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ëª¨ë¸ì„ ë¨¼ì € í›ˆë ¨ì‹œì¼œ ì£¼ì„¸ìš”.</p>';
            return;
        }

        const ctx = document.getElementById('metricsChart').getContext('2d');
        new Chart(ctx, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: chartDatasets
          },
          options: {
            responsive: true,
            plugins: {
              title: {
                display: true,
                text: 'ëª¨ë¸ë³„ ì„±ëŠ¥ ì§€í‘œ ë¹„êµ (ë‹¨ìœ„: %)',
                font: {
                    size: 18
                }
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    let label = context.dataset.label || '';
                    if (label) {
                      label += ': ';
                    }
                    if (context.parsed.y !== null) {
                      label += context.parsed.y.toFixed(2) + '%';
                    }
                    return label;
                  }
                }
              }
            },
            animation: {
              duration: 1500,
              easing: 'easeOutBounce'
            },
            scales: {
              y: {
                beginAtZero: true,
                // max: 100, // yì¶• ìµœëŒ€ê°’ì„ ìë™ìœ¼ë¡œ ì¡°ì ˆí•˜ë„ë¡ ì£¼ì„ ì²˜ë¦¬
                ticks: {
                  // yì¶•ì— % ê¸°í˜¸ ì¶”ê°€
                  callback: function(value) {
                    return value + '%';
                  }
                }
              }
            }
          }
        });
      })
      .catch(error => {
        console.error('Error fetching or parsing metrics.json:', error);
        document.body.innerHTML += `<p>ì„±ëŠ¥ ì§€í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</p>`;
      });
  </script>
</body>
</html>
